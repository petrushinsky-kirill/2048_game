const t=new class{constructor(t){this.size=4,this.score=0,this.status="idle",t?this.board=[...t]:this.board=Array.from({length:this.size},()=>Array(this.size).fill(0))}moveLeft(){let t=!1;for(let e=0;e<this.size;e++){let s=this.board[e],i=this.mergeRow(s);this.arraysCompare(s,i)||(this.board[e]=i,t=!0)}t&&(this.addRandomTile(),this.getStatus())}moveRight(){let t=!1;for(let e=0;e<this.size;e++){let s=this.board[e],i=s.slice().reverse(),r=this.mergeRow(i).reverse();this.arraysCompare(s,r)||(this.board[e]=r,t=!0)}t&&(this.addRandomTile(),this.getStatus())}moveUp(){let t=!1;for(let e=0;e<this.size;e++){let s=[];for(let t=0;t<this.size;t++)s.push(this.board[t][e]);let i=this.mergeRow(s);for(let s=0;s<this.size;s++)this.board[s][e]!==i[s]&&(this.board[s][e]=i[s],t=!0)}t&&(this.addRandomTile(),this.getStatus())}moveDown(){let t=!1;for(let e=0;e<this.size;e++){let s=[];for(let t=0;t<this.size;t++)s.push(this.board[t][e]);let i=s.reverse(),r=this.mergeRow(i).reverse();for(let s=0;s<this.size;s++)this.board[s][e]!==r[s]&&(this.board[s][e]=r[s],t=!0)}t&&(this.addRandomTile(),this.getStatus())}getScore(){return this.score}getState(){return[...this.board]}getStatus(){if("win"===this.status||"lose"===this.status)return this.status;for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(2048===this.board[t][e])return this.status="win",this.status;return this.canMove()?this.status="playing":this.status="lose",this.status}start(){this.board=Array.from({length:this.size},()=>Array(this.size).fill(0)),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.board=Array.from({length:this.size},()=>Array(this.size).fill(0)),this.score=0,this.status="idle",this.addRandomTile(),this.addRandomTile()}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(0===t.length)return;let{row:e,col:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}mergeRow(t){let e=t.filter(t=>0!==t),s=[];for(let t=0;t<e.length;t++)if(e[t]===e[t+1]){let i=2*e[t];s.push(i),this.score+=i,t++}else s.push(e[t]);for(;s.length<t.length;)s.push(0);return s}arraysCompare(t,e){return t.every((t,s)=>t===e[s])}canMove(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){let s=this.board[t][e];if(0===s||e<this.size-1&&this.board[t][e+1]===s||t<this.size-1&&this.board[t+1][e]===s)return!0}return!1}};h();const e=document.querySelector(".button.start"),s=document.querySelector(".button.restart"),i=document.querySelector(".game-score"),r=document.querySelectorAll(".field-cell");function o(){let e=t.getState();for(let s=0;s<t.size;s++)for(let i=0;i<t.size;i++){let t=e[s][i];r[4*s+i].textContent=0===t?"":t}r.forEach(t=>{let e=t.textContent;t.classList.forEach(e=>{e.startsWith("field-cell--")&&t.classList.remove(e)}),e&&t.classList.add(`field-cell--${e}`)})}function a(){i.textContent=t.score}function h(){let e=document.querySelector(".message-win"),s=document.querySelector(".message-lose"),i=document.querySelector(".message-start"),r=t.status;"win"===r&&e.classList.remove("hidden"),"lose"===r&&s.classList.remove("hidden"),"playing"===r&&i.classList.add("hidden")}e.addEventListener("click",()=>{t.start(),o(),a(),h()}),s.addEventListener("click",()=>{t.restart(),o(),a(),h()}),document.addEventListener("keydown",e=>{if("playing"!==t.status)return;let s=!1;"ArrowLeft"===e.key&&(t.moveLeft(),s=!0),"ArrowRight"===e.key&&(t.moveRight(),s=!0),"ArrowUp"===e.key&&(t.moveUp(),s=!0),"ArrowDown"===e.key&&(t.moveDown(),s=!0),s&&(o(),a(),h())});
//# sourceMappingURL=index.ee1bd8b4.js.map
